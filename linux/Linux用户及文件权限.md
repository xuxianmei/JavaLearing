缺乏安全性的系统不是完整的系统。系统中必须有一套能够保护文件免遭非授权用户浏览或修改的机制。
linux没用了Unix文件权限的方法，即允许**用户**和**组**根据每个**文件**和**目录**的安全性设置来访问文件。

## Linux的安全性

Linux安全系统的核心是**用户账户**。
每个能进入Linux系统的用户都会被分配唯一的用户账号。  
用户权限是通过创建用户时分配的用户ID(UID)来跟踪的。

用户账户在控制单个用户安全性方面很好用，但涉及在共享资源的一组用户时就捉襟见肘了。  
为了解决这个问题，Linux系统采用了另外一个安全概念---组(group)，标识为GID。

当Linux用户登录系统之后，就会有一个UID和GID，相当于自己的名片，当需要访问文件或程序时，  
刷一下名片就能知道是否能读、写、执行了。

Linux系统使用特定的文件和工具来跟踪和管理系统上的用户账户。

一般来说，Linux的用户信息保存在/etc/passwd中，组信息保存在/etc/group中，  
文件的每一行代表一个用户/组。
早期的Linux将密码以明文形式保存在/etc/passwd中，而现在多以暗码（也就是加密之后的形式）  
保存在/etc/shadow中。/etc/shadow只允许root用户查看。

### /etc/passwd文件
``name:password:UID:GID:GECOS:directory:shell``

1. name：用户名
2. password：可以是加密的密码，也可以是占位符x
3. UID：用户ID
4. GID：用户所属的基本组ID
5. GECOS：可选，用户的注释信息
6. directory：用户的主目录
7. shell：用户登陆时的默认shell

root用户账户是Linux系统的管理员，固定分配给它的UID是0.
Linux系统会为各种各样的功能创建不同的用户账户，而这些账户并不是真的用户，这些账户叫作  
系统账号，是系统上运行的各种服务进程访问资源用的特殊账户。
Linux为系统账户预留了500以下的UID值。有些服务甚至要用特定的UID才能正常工作。

### /etc/shadow

此文件对Linux系统密码管理提供了更多的控制，只有root用户才能访问/etc/shadow文件，  
这让它比起/etc/passwd安全许多。

字段说明
1. name:用户名。

2. $加密算法$salt$加密密码：salt称为杂质，加密时添加。

3. 最近一次修改密码的时间：表示从1970年1月1日（unix元年）开始的天数；0表示用户下次登录时应该更改密码；空字段表示这个功能被禁止。

4. 多少天后才能更改密码

5. 多少天后必须更改密码

6. 密码过期前，提前多少天提醒用户更改密码

7.  密码过期后多少天禁用用户账户

8.  用户账户被禁用的日期（用自1970年1月1日当天的天数表示）

9.  保留字段

### /etc/group
与用户账户类似，组信息也保存在系统的一个文件中。
/etc/group文件包含系统上用到的每个组的信息。
/etc/group文件有4个字段：
``group_name:password:GID:user_list``
1. 组名
2. 组密码
3. 用户组ID（GID）
4. 属于该组的用户列表（以该组为其附加组的用户的用户列表，）

组密码允许非组内成员通过它临时为该组成员。
**注：**
>用户账户列表在某种意义上有些误导人，你会发现，在列表中，有些组并没有列出用户。  
>这并不是说这些组没有成员。当一个用户在/etc/passwd文件中指定某个组作为默认组时，  
>用户账户不会作为该组成员再出现在/etc/group文件中。



## 文件权限

在Linux中的每一个文件或目录包含有访问权限，这些访问权限决定了谁能访问和如何访问这些文件和目录。

每个权限都可以针对三种对象进行设置：
* 对象的属主（所有者）
* 对象的属组（用户组）
* 系统其他用户

可以通过使用 ``ls -l``命令显示查看文件权限。
```
-rwxrwx--- 1 root plugdev 18M 2007-02-28 18:05 ActionCube_v0.92.tar.bz2
-rwxrwx--- 1 root plugdev 60M 2007-04-30 22:52 nexuiz-223.zip
-rwxrwx--- 1 root plugdev 7.4M 2007-04-25 02:16 stardict-oxford-gb-2.4.2.tar.bz2
-rwxrwx--- 1 root plugdev 102M 2007-05-01 18:22 tremulous-1.1.0-installer.x86.run
-rwxrwx--- 1 root plugdev 4.9M 2007-04-30 14:32 wqy-bitmapfont-0.8.1-7_all.deb.bin
```
各字段：
1. 文件类型及权限
就是描述文件和目录权限的编码。  
这个字段的第一个字符代表了对象的类型：
	* \- 代表文件
	* d 代表目录
	* l 代表链接
	* c 代表字符型设备
	* b 代表块设备
	* n 代表网络设备	  
之后九个符符，表示文件的权限
若没有某种权限，在该权限位会出现 ``-``。

2. 文件的硬链接数

3. 拥有者的用户名

4. 文件所有组的组名

5. 文件的大小

6. 文件的上次修改时间

7. 文件名或目录名





### 一般权限
第一字段第2～10个字符当中的每3个为一组，左边三个字符表示所有者权限，中间3个字符表示与所有者同一组的用户的权限，右边3个字符是其他用户的权限。这三个一组共9个字符，每个字符代表的意义如下：
* r(Read，读取)  八进制表示：4
对文件而言，具有读取文件内容的权限；对目录来说，具有浏览目录的权限（查询该目录下的文件名数据）。

* w(Write，写入)  八进制表示：2
对文件而言，具有可编辑该文件的内容的权限（不含删除该文件）；对目录来说，具有新建文件/目录、删除文件/目录、重命名、转移位置。


* x(eXecute，执行)  八进制表示：1
对文件而言，具有执行文件的权限；对目录来说该用户具有进入目录的权限（cd 进入）。

如果在不包含指定权限，该字符则是``-``。

权限针对文件来说，只针对文件内部的内容，与文件的建立、删除、移动无关。

目录的权限是相对目录下的子目录、文件的整体操作，要开放目录给任何人浏览，至少给r和x权限，且进入目录后，文件和子目录的权限完全由  
其自身决定。



### 特殊权限 SUID,SGID,SBIT
* SUID   4
	* 出现形式
	当s出现在文件所有者的x权限上时，为SUID。
	* 作用对象
	仅适用于文件，对目录不支持。 
	* 权限特点
		* 仅对二进制程序有效
		* 程序执行者对该文件、需要具备X权限  
		* 仅在执行该程序的过程中有效
		* 执行该程序的用户将具有该程序所有者的权限


* SGID  2
	* 再现形式
    出现在用户组的权限x上，如：-rwx--s--x
	* 作用对象
	适用于文件与目录		
	* 权限特点 
		* SGID对文件的功能
			* 对二进制程序有用
			* 程序执行者对于该程序来说，需具备x权限
			* 程序者在执行该程序时获得程序用户组的支持（有用户组的权限）
		* SGID对目录的功能
			* 用户若有r与x则可进入此目录
			* 用户在此目录下的有效用户组，会成为该目录的用户组
			* 用户若对此目录有w，则其创建的文件的用户组与此目录的用户组相同。 


* SBIT  1
	* 再现形式
	t再现在others的x上
	* 作用对象
	仅适用于目录
	* 权限特点
	若用户对此目录有w x 权限，在此目录下创建文件/目录时，仅有自己与root可删除该文件、目录。

注：若S和T都是大写，则代表不具有x权限。




### 默认文件权限
``umask``命令用来设置所创建文件和目录的默认权限。
#### 八进制模式的安全性设置

使用此命令时，查询的是``umask``的值。
如：0022
第一位代表了一项特别的安全特性，叫作粘着位(sticky bit)。

| 权限 | 二进制值 | 八进制值 | 描述 |
---|---|---|---
| ``---`` | 000 | 0| 没有任何权限|
| ``--x`` | 001 | 1| 只有执行权限|
| ``-w-`` | 010 | 2| 只有写入权限|
| ``-wx`` | 011 | 3| 有写入和执行权限|
| ``r--`` | 100 | 4| 只有读取权限|
| ``r-x`` | 101 | 5| 有读取和执行权限|
| ``rw-`` | 110 | 6| 有读取和写入权限|
| ``rwx`` | 111 | 7| 有全部权限|



umask的值只是掩码。它会屏蔽掉不想授予该安全级别的权限。
对文件来说，全权限的值是666，而对目录来说，则是777。
所以文件一开始的权限是666-022=644，目录的权限是777-022=755。
可以用mask命令为默认umask设置指定一个新值。












参考:
[浅析Linux系统下用户与权限管理](http://www.linuxidc.com/Linux/2015-12/126635.htm)
[Linux基础：权限与文件](http://wuchong.me/blog/2014/07/15/linux-permission-and-file/)