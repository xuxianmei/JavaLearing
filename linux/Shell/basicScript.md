
Shell脚本的关键在于，输入多个命令并处理每个命令的结果。
Shell可以将多个命令串起来，一次执行完成。

## 使用多个命令
如果要将两个命令一起运行，可以将它们放在同一行中，使用分号隔开。

````
command1;command2;command3;...
````
比如：

````
date;who;
````

## 创建Shell脚本文件
要将shell命令放到文本文件中，首先需要文本编辑器来创建一个文件，然后将命令输入到文件中。

基本格式：
```
#!指定shell
# 注释
命令
...
```
第一行：指定使用哪个shell来运行脚本。比如：
```
#!/bin/bash 
``` 
运行脚本前提：
1. 运行用户，需要有x权限
2. 如果不将脚本路径加入到PATH环境变量中，需要使用**路径+文件名**来调用

## 显示输出内容

```
echo string|'string'|"string"
```
比如：
````
echo this is a test
````

默认情况，不需要使用引号将要显示的文本字符划定起来。
如果要使用，可以使用单引号或双引号。
比如：
中使用其中一种引号，而用另外一种来将字符串划定起来。

````
echo "That's good"
````

````
echo  'Rich says "shell is good"'
````

更多echo相关：man echo，比如-n：不在末尾输出一个新行。


## 变量

变量可以存储数据，在任何能访问到它们的地方使用。

### 用户变量
shell脚本允许在脚本中定义和使用变量。
用户变量主要是为了临时存储数据并在整个中使用。
>区别大小写
>``=``号两边相邻位置不能有空格
>生命周期限于脚本执行过程结束前。
>shell脚本会自动决定变量值的数据类型。



* 定义或重新赋值
```
variable_name=value
```
* 引用变量的值
```
$variable_name
${variable_name}
```

### 环境变量


shelll维护着一组环境变量，用来记录特定的系统信息。

在脚本中，有两种方式可以使用这些环境变量：

```
$variable_name
${variable_name}
```

比如
````
echo $USER
echo ${UID}
````


### 引用命令输出（命令替换）

shell脚本中最有用的特性之一就是，可以从命令输出中提取信息，并将其赋值给变量。
命令替换允许命令的输出替换命令本身。

>命令由子shell执行（故无法使用父shell中的用户变量）
>类似于调用函数，返回函数的返回值
>支持多个命令

* 反引号字符**`**或$()

```
`command1[;command2]...`
$(command[;command2]...)
```

比如

````
today=$(date +%y%m%d)

ls /bin -al > $today.log

或者

ls /bin -al > $(date +%y%m%d).log
````

## 数学运算


### 使用方括号

>bash数学运算符只支持整数运算。（zsh提供了完整的浮点运算操作。）
>如果不使用方括号，需要将一些操作符进行转义，所以建议直接使用此方式。
``$[计算表达式]``

比如

````
var1=$[1+5]
var2=$[$var1*2]
echo var2
````

注：

### 浮点解决方案

#### bc（TODO）
bc，或者直接使用zsh。或者fish shell

zsh数值运算：TODO
zsh编程。TODO


## 退出脚本
shell中运行的每个命令都使用退出状态码告诉shell它已经执行完毕。
退出状态码是一个0~255的整数值，在命令结束运行时由命令传给shell。
>exitcode如果大于255，数值会对255取模运算。

默认情况下，shell脚本会以脚本中的最后一个命令的退出状态码退出。

可以在脚本中输入exit来退出状态码（不一定是最后一行）。
```
exit status
```

### 退出状态码

状态码|描述
---|---
0|命令成功结束
1|一般性未知错误
2|不适合的shell命令
126|命令不可执行
127|没有找到该命令
128|无效的退出参数
128+x|与Linux信号x相关的严重错误
130|CTRL+C终止的命令
255|正常范围之外的退出状态码



### 查看退出状态码

Linux提供一个专门的变量$?来保存上个已执行命令的退出状态码。

按照惯例，一个成功结束的命令的退出状态码是0。